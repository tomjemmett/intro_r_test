---
title: "Introduction to R and Rstudio"
subtitle: "Session 1"
author: "Zoë Turner"
institute: "NHS-R Community"
output:
  xaringan::moon_reader:
    css: 
      - default
      - css/nhsr.css
      - css/nhsr-fonts.css
    lib_dir: libs
    seal: false
    nature:
      highlightStyle: googlecode
      highlightLines: true
      highlightLanguage: ["r"]
      countIncrementalSlides: false
      ratio: "16:9"
    includes:
      after_body: [css/insert-logo.html]

---

class: title-slide, left, bottom
```{r libs, include=FALSE}

#knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, results = 'asis')

#Runs packages if available
library(knitr)
library(magick)
library(tidyverse)
library(xaringan)
library(nhsrtheme)

# Packages not on CRAN

# install.packages("remotes")
# remotes::install_github("mitchelloharawild/icon")
library(icon) # icons need to be loaded to view so run following code if not already done
# icon::download_fontawesome()

opts_chunk$set(echo = FALSE,
               fig.width = 7.252,
               fig.height = 4,
               dpi = 300,
               dev.args = list(type = "cairo"))

# uncomment the following lines if you want to use the NHS-R theme colours by default
scale_fill_continuous <- partial(scale_fill_nhs, discrete = FALSE)
scale_fill_discrete <- partial(scale_fill_nhs, discrete = TRUE)
scale_colour_continuous <- partial(scale_colour_nhs, discrete = FALSE)
scale_colour_discrete <- partial(scale_colour_nhs, discrete = TRUE)

```

```{r echo=FALSE}
xaringanExtra::use_logo(
  image_url = "img/nhsr-logo.png",
  exclude_class = c("title-slide", "inverse", "hide-logo")
)
```

# `r rmarkdown::metadata$title`
----
## **`r rmarkdown::metadata$subtitle`**
### `r rmarkdown::metadata$author`
### `r rmarkdown::metadata$date`

---

# 1-2-4

<br/>
<br/>

###1. (Name)
###2. What would be a good result today?

.left-col[.right[3:00 minutes]]

---

# Our work

</br>
* Describe paediatric services across the region.
* Did such and such mental health intervention work?
* What influences demand for elective treatment?

</br>  
.left-col[.center[
Tools: R, Excel, SQL, QGIS….
]]   

</br>
Answers: Reports (Powerpoint and Word) and presentations

---
# Assumptions about you

.left-col[.center[What is the nature of your work? <br/>
Reporting? <br/> 
<br/> Project based? <br/>
<br/> Data reconciliation? Statistics? <br/>
<br/> Collaboration? <br/>
<br/> Tools – Excel, SQL, Power BI? Tableau? <br/>
<br/> Answers – Reports? Presentations? <br/>
<br/> Will shape what you want from today.]]

---

# Agenda

.left-col[.center[
###“Adjusting the seat and mirrors”:<br/>
<br/>Intro + Setup + Import data<br/>
<br/>Graphics with ggplot2<br/>
<br/>Break 15 mins<br/>
<br/>Data wrangling with dplyr<br/>
<br/>--------- Lunch -----------<br/>
<br/>Demo<br/>
<br/>Naming objects | Joins<br/>
<br/>R Markdown
]]  
---



.left-col[.center[
# Course Aims
</br>
####1. To show you some of the possibilities:
####2. To give you a feel for how R works.
####3. To show you enough for you to begin teaching yourself
_(Excellent free resources available)_
]]

---

class: inverse, middle, center


.left-col[.center[
###_elegant_
#Graphics
]]

---
Credit: [Colin Angus](https://github.com/VictimOfMaths/COVID-19)

.left-col[

<img src="img/heatmap_colin_angus.PNG" width="1000%"/>
]

---

<img src="img/london_cycle_routes.PNG" width="90%"/>

---

# Collaboration


.left-col[.center[

## Reproducibility

`r icon::fontawesome("arrow-down")`

### R Markdown

]]

---

<img src="img/automated_reports.PNG" width="1000%"/>

---

# (Interactive) Dashboards

[Mental Health Surge Modelling](https://strategyunit.shinyapps.io/MH_Surge_Modelling/)

<img src="img/mental_health_modelling.PNG" width="1000%"/>


---

.left-col[.center[
# R to SQL connection
]]

[NHS-R Community Webinar](https://nhsrcommunity.com/learn-r/workshops/database-connections-in-r-webinar)

<img src="img/webinar_nhsr.PNG" width="1000%"/>

---

[Trafford Data Lab](https://trafforddatalab.shinyapps.io/trafford-tweet-dash/)

<img src="img/twitter_dash.PNG" width="1000%"/>

---

<img src="img/stackoverflow_example.PNG" width="1000%"/>

---

# Inclusivity

.left-col[.center[

```{r inclusive}

rladies <- image_read('img/r_ladies_twitter.PNG')
mir <- image_read('img/mir_twitter.PNG')
nhsr <- image_read('img/nhsr_twitter.PNG')

img <- c(rladies, mir, nhsr)

image_animate(image_scale(img, "600x600"), fps = 1, dispose = "previous")

```

]]
---

class: inverse, middle, center

.left-col[.center[
_elegant_
## Course Philosophy
]]

---

[Minimum Viable Product](https://blog.crisp.se/2016/01/25/henrikkniberg/making-sense-of-mvp)

.left-col[.center[
<img src="img/mvp.PNG" width="75%"/>
]]

---

.left-col[.center[
# Course philosophy

</br> Relaxed and informal </br>
</br> (Slides and code are available [online](https://github.com/nhs-r-community/intro_r)) </br>
</br> The truth; but it can’t be the whole truth… </br>
</br> too much to cover in a day)</br>
]]

---

class: inverse, middle, center


.left-col[.center[
# Let's begin
]]

---

.left-col[.center[
## R vs. RStudio
R is a programming language
</br>
</br>
RStudio is a software application with tools to
</br>
</br>
improve your programming experience
]]

---

<img src="img/race_car.jpg"/>

---

<img src="img/roberto-nickson-unsplash.jpg"/>

---

.left-col[.center[

# RStudio 

</br>
</br>
Many excellent features to help you with your analyses.

</br>
</br>
Never again have to think about R and RStudio as separate:
Opening R Studio opens an R session.

</br>
</br>
Analogy from the book Modern Dive:
[www.moderndive.com](www.moderndive.com)
]]

---

.left-col[.center[
# Open RStudio

</br>
</br>
Opening R

</br>
Studio opens an R session.
]]

---

.left-column[
The Console is your window to R. 
</br>
</br>
You can code directly in the console… 
</br>
</br>
pi*2 [Enter] 
</br>
</br>
37/12 [Enter] 
</br>
</br>
… but there is a better way…
]

.right-column[

<img src="img/rstudio_console.PNG"/>

]

---

.left-column[
#### The Editor
</br>
</br>
If you don’t see the Editor pane, click top right button
</br>
</br>
And choose "R Script" from the drop down. 
</br>
</br>
Or, shortcut: 
</br>
Ctrl+ Shift+ N
</br>
.blue[_won't work on the cloud_]
]

.pull-right[

<img src="img/new_file.PNG"/>

]
---

.left-column[
The Editor is just like any other text
editor: you can copy, paste, and save text.
</br>
</br>
More forgiving R Syntax
highlighting
</br>
</br>
Autocomplete (use it!)
</br>
</br>
Ctrl + Enter
(sends line of
code to Console)
]

.right-column[
<img src="img/editor.PNG"/>
]

---

.left-column[
Comment code with a #
</br>
</br>
E.g # this was a
bad idea
]

.right-column[
<img src="img/editor.PNG"/>
]

---

.left-col[.center[
# Tools -> Options

<img src="img/global_options.PNG"/>
]]

---

.left-col[.center[
# Tools -> Options

<img src="img/appearance.PNG"/>
]]

---

.left-col[.center[
# Packages
]]

---

.left-col[.center[
# Packages
</br>
#### R packages are like apps for your phone:
</br>
</br>
Extend the capabilities of the basic or "base R"
</br>
with extra functions, datasets, documentation.

]]
---

.left-col[.center[

<img src="img/app_analogy.PNG"/>
]]

---

.left-col[.center[
# Packages
</br>
install.packages("tidyverse")
</br>
</br>
.green[will download a package to your personal library. Then:]
</br>
</br>
library(tidyverse)
</br>
</br>
.green[tells R to load the tidyverse package from your personal library.
_(Needed for every new session)_]
]]

---

.left-col[.center[

## CRAN repository
</br>
</br>
14,000+ packages. Free. Peer reviewed.
</br>
</br>
(Manifold possibilities) eg. interactive graphics and
</br>
</br>
dashboards, machine learning, mine twitter data,
</br>
</br>
create PowerPoint docs, maps…
</br>
</br>
</br>
</br>
.blue[Other ways to get packages (eg. GitHub, …)]
]]
---

.left-col[.center[

<img src="img/tidyverse.PNG"/>
]]

---

.left-col[.center[

## What is the tidyverse?
</br>
</br>
The tidyverse package collects (some of) the most popular 
</br>
R packages into one.
</br>
</br>
All have the same underlying principles:
</br>
</br>
Provide simple tools (with consistent structure) which may 
</br>
be used together to help solve complex problems.
]]

---

.left-col[.center[

## What is the tidyverse?
</br>
</br>
During the workshop we will use the .blue[ggplot2], .blue[dplyr],
</br>
and .blue[readr] packages. These are bundled up in the
</br>
tidyverse package. We load it by running:
</br>
</br>
</br>
library(tidyverse)
]]

---

.left-col[.center[
#### This work is licensed as
</br>
Creative Commons
</br>
Attribution
</br>
ShareAlike 4.0
</br>
International
</br>
To view a copy of this license, visit
</br>
https://creativecommons.org/licenses/by sa/4.0/
]]

---

name: goodbye
class: middle, inverse

# **Thank you!**
<br/>

Acknowledgements: for creating the original training slides and delivering training:

Andrew Jones | Ozayr Mohammed <br/>
Healthcare Analysts | The Strategy Unit

[`r icon::fontawesome("paper-plane")` andrew.jones40@nhs.net](mailto:andrew.jones40@nhs.net)<br/>

[`r icon::fontawesome("paper-plane")` ozayr.mohammed@nhs.net](mailto:ozayr.mohammed@nhs.net)

And to Silvia Canelón who created the Xaringan presentation using NHS and NHR-R colour branding and shared this at the 2020 [NHS-R Community conference](https://spcanelon.github.io/xaringan-basics-and-beyond/index.html). <br/>

Details of the workshops she ran at the [NHS-R Community conference](https://spcanelon.github.io/xaringan-basics-and-beyond/index.html).

And to Zoë Turner who converted the presentation to Xaringan. [`r icon::fontawesome("paper-plane")` zoe.turner2@notthshc.nhs.uk](mailto:zoe.turner2@nottshc.nhs.uk) 
